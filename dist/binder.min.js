"use strict";window.bimo=window.bimo||{},window.bimo.Bind=function(e){var n,t,o,r,l,i,s,f,a,c,d=this,u={};for(n in"string"==typeof(e=e||{}).config&&(e.config={selector:e.config}),e.config=e.config||{},t=function(e,n,t){e.attachEvent?e.attachEvent("on"+n,t):e.addEventListener(n,t)},o=function(e,n){var t,o,r;if(d.options&&(e.options.length=0,d.placeHolder&&((t=document.createElement("option")).value="",t.innerHTML=d.placeHolder,null!=n&&""!==n||(t.selected="selected"),t.disabled="disabled",e.appendChild(t)),o="function"==typeof d.options?d.options.call(d):d.options)){if(Array.isArray(o)){for(var l={},i=0,s=o.length;i<s;i++)l[o[i]]=o[i];o=l}for(r in o)o.hasOwnProperty(r)&&((t=document.createElement("option")).value=r,t.innerHTML=o[r],r===n&&(t.selected="selected"),e.appendChild(t))}},r=function(e,n,t){e.detachEvent?e.detachEvent("on"+n,t):e.removeEventListener(n,t)},l=function(e,n){var result=function(e){n.call(d,e)};return u[e]=result,result},i=function(e){return null==e},s=function(e){var n;if(null!==e)if(-1!==["SELECT","INPUT","TEXTAREA"].indexOf(e.nodeName)){var t=e.type.toLowerCase();n="checkbox"===t?e.checked:"file"===t?e.files:"number"===t?Number(e[d.property]):"date"===t?new Date(e.value):"time"===t?e.value:"datetime-local"===t?new Date(e.value):e[d.property]}else n=e.innerHTML;return"function"==typeof d.write&&(n=d.write.call(d,n,e)),n},f=function(e){if("function"==typeof d.read)d.read.call(d,e);else if(!i(d.elements))for(var n=0,t=d.elements.length;n<t;n++)if(-1!==["SELECT","INPUT","TEXTAREA"].indexOf(d.elements[n].nodeName)){var o=d.elements[n].type.toLowerCase();i(e)?"checkbox"===o?d.elements[n].checked=!1:"file"===o||""!==d.elements[n][d.property]&&(d.elements[n][d.property]=""):"checkbox"===o?d.elements[n].checked!==e&&(d.elements[n].checked=e):"file"===o||("date"===o?"string"==typeof e?d.elements[n].value=e:e&&"function"==typeof e.toISOString&&(d.elements[n].value=e.toISOString().substr(0,10)):"time"===o?"string"==typeof e?d.elements[n].value=e:e&&"function"==typeof e.toISOString&&(d.elements[n].value=e.toISOString().substr(11,5)):"datetime-local"===o?"string"==typeof e?d.elements[n].value=e:e&&"function"==typeof e.toISOString&&(d.elements[n].value=e.toISOString()):d.elements[n][d.property]!==e&&(d.elements[n][d.property]=e))}else i(e)?""!==d.elements[n].innerHTML&&(d.elements[n].innerHTML=""):d.elements[n].innerHTML!==e&&(d.elements[n].innerHTML=e)},a=function(e){if(d.twoWay){var n=s(e.target);void 0!==n&&(d.model[d.key]=n)}},c=function(e){for(var n in e)e.hasOwnProperty(n)&&d.key===n&&f(d.model[n])},d.bind=function(e){var n,r,s;if(!i(d.elements)){for(n=0,r=d.elements.length,n=0;n<r;++n)"SELECT"===d.elements[n].nodeName&&o(d.elements[n],d.model[d.key]);f(d.model[d.key])}if(d.model._watch(d.key,c),d.twoWay&&!i(d.elements))for(n=0,r=d.elements.length,n=0;n<r;++n)t(d.elements[n],d.event,a);for(s in d.events)if(d.events.hasOwnProperty(s)&&"function"==typeof d.events[s]){var u=l(s,d.events[s]);for(n=0,r=d.elements.length,n=0;n<r;++n)t(d.elements[n],s,u)}"function"==typeof e&&e.call(d)},d.unbind=function(e){var n,t,o;if(d.model._unwatch(d.key,c),d.twoWay)for(n=0,t=d.elements.length;n<t;++n)r(d.elements[n],d.event,a);for(o in u)if(u.hasOwnProperty(o))for(n=0,t=d.elements.length;n<t;++n)r(d.elements[n],o,u[o]);"function"==typeof e&&e.call(d)},Object.defineProperty(d,"visible",{enumerable:!0,configurable:!0,get:function(){var e=!0;return i(d.elements)||i(d.elements[0])||(e="none"!==d.elements[0].style.display),e},set:function(e){for(var n=0,t=d.elements.length;n<t;n++)d.elements[n].style.display=e?d.display||"":"none"}}),Object.defineProperty(d,"disabled",{enumerable:!0,configurable:!0,get:function(){var e=!1;return i(d.elements)||i(d.elements[0])||(e=d.elements[0].disabled),e},set:function(e){for(var n=0,t=d.elements.length;n<t;n++)d.elements[n].disabled=e}}),Object.defineProperty(d,"readOnly",{enumerable:!0,configurable:!0,get:function(){var e=!1;return i(d.elements)||i(d.elements[0])||-1===["INPUT","TEXTAREA"].indexOf(d.elements[0].nodeName)||(e=d.elements[0].readOnly),e},set:function(e){for(var n=0,t=d.elements.length;n<t;n++)-1!==["INPUT","TEXTAREA"].indexOf(d.elements[n].nodeName)&&(d.elements[n].readOnly=e)}}),Object.defineProperty(d,"required",{enumerable:!0,configurable:!0,get:function(){var e=!1;return i(d.elements)||i(d.elements[0])||(e=d.elements[0].required),e},set:function(e){for(var n=0,t=d.elements.length;n<t;n++)d.elements[n].required=e}}),e)e.hasOwnProperty(n)&&"config"!==n&&(d[n]=e[n]);for(n in d.twoWay=void 0===d.twoWay?e.defaults.twoWay:d.twoWay,d.event=d.event||e.defaults.event,d.property=d.property||e.defaults.property,d.elements=e.config.elements||null,d.selector=e.config.selector||null,e.config)e.config.hasOwnProperty(n)&&(d[n]=e.config[n]);if(d.events=d.events||{},i(d.elements))if(i(d.selector))d.elements=null;else if(d.elements="string"==typeof d.selector?d.container.querySelectorAll(d.selector):d.selector,null===d.elements)throw new Error(['"',d.selector.toString(),'" element not found!'])},window.bimo.Binder=function(e){var n,t=this;n=function(e){var n=e;if(null==n)n=document;else if("string"==typeof e&&null===(n=document.querySelector(n)))throw new Error(['"',e,'" container selector not found!']);return n},t.container=n(e.container),t.model=e.model||{},t.binds={},t.run=function(e){var n,o=function execute(n){"function"==typeof n[e]&&n[e].call(n)};for(n in t.binds)if(t.binds.hasOwnProperty(n))if(Array.isArray(t.binds[n]))for(var r=0,l=t.binds[n].length;r<l;r++)o(t.binds[n][r]);else o(t.binds[n])},t.init=function(e,o,r,l){var i;if(e&&(t.container=n(e)),t.model=o,r)for(i in l=l||{twoWay:!0,event:"change",property:"value"},r)if(r.hasOwnProperty(i))if(!0===Array.isArray(r[i])){t.binds[i]=[];for(var s=0,f=r[i].length;s<f;s++){var a=new window.bimo.Bind({container:t.container,model:t.model,key:i,config:r[i][s],defaults:l});t.binds[i].push(a)}}else t.binds[i]=new window.bimo.Bind({container:t.container,model:t.model,key:i,config:r[i],defaults:l})},t.bind=function(e){t.run("bind"),"function"==typeof e&&e.call(t)},t.unbind=function(e){t.run("unbind"),"function"==typeof e&&e.call(t)},e.model&&e.config&&t.init(t.container,t.model,e.config,e.defaults)};