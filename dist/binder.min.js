"use strict";window.bimo=window.bimo||{},window.bimo.Bind=function(e){var n,i,l,r,s,f,t,c,a,d,u=this,m={};for(n in"string"==typeof(e=e||{}).config&&(e.config={selector:e.config}),e.config=e.config||{},i=function(e,n,t){e.attachEvent?e.attachEvent("on"+n,t):e.addEventListener(n,t)},l=function(e,n){var t,o,r;if(u.options&&(e.options.length=0,u.placeHolder&&((t=document.createElement("option")).value="",t.innerHTML=u.placeHolder,null!=n&&""!==n||(t.selected="selected"),t.disabled="disabled",e.appendChild(t)),o="function"==typeof u.options?u.options.call(u):u.options)){if(Array.isArray(o)){for(var i={},l=0,s=o.length;l<s;l++)i[o[l]]=o[l];o=i}for(r in o)o.hasOwnProperty(r)&&((t=document.createElement("option")).value=r,t.innerHTML=o[r],r===n&&(t.selected="selected"),e.appendChild(t))}},r=function(e,n,t){e.detachEvent?e.detachEvent("on"+n,t):e.removeEventListener(n,t)},s=function(e,n){function t(e){n.call(u,e)}return m[e]=t},f=function(e){return null==e},function(e){return"[object Object]"===Object.prototype.toString.call(e)},t=function(e){var n;if(null!==e)if(-1!==["SELECT","INPUT","TEXTAREA"].indexOf(e.nodeName)){var t=e.type.toLowerCase();n="checkbox"===t?e.checked:"file"===t?e.files:e[u.property]}else n=e.innerHTML;return"function"==typeof u.write&&(n=u.write.call(u,n,e)),n},c=function(e){if("function"==typeof u.read)u.read.call(u,e);else if(!f(u.elements)&&!f(e))for(var n=0,t=u.elements.length;n<t;n++)if(-1!==["SELECT","INPUT","TEXTAREA"].indexOf(u.elements[n].nodeName)){var o=u.elements[n].type.toLowerCase();"checkbox"===o?u.elements[n].checked!==e&&(u.elements[n].checked=e):"file"===o||u.elements[n][u.property]!==e&&(u.elements[n][u.property]=e)}else u.elements[n].innerHTML!==e&&(u.elements[n].innerHTML=e)},a=function(e){if(u.twoWay){var n=t(e.target);void 0!==n&&(u.model[u.key]=n)}},d=function(e){for(var n in e)e.hasOwnProperty(n)&&u.key===n&&c(u.model[n])},u.bind=function(e){var n,t,o;if(!f(u.elements)){for(n=0,t=u.elements.length,n=0;n<t;++n)"SELECT"===u.elements[n].nodeName&&l(u.elements[n],u.model[u.key]);c(u.model[u.key])}if(u.model._watch(u.key,d),u.twoWay&&!f(u.elements))for(n=0,t=u.elements.length,n=0;n<t;++n)i(u.elements[n],u.event,a);for(o in u.events)if(u.events.hasOwnProperty(o)&&"function"==typeof u.events[o]){var r=s(o,u.events[o]);for(n=0,t=u.elements.length,n=0;n<t;++n)i(u.elements[n],o,r)}"function"==typeof e&&e.call(u)},u.unbind=function(e){var n,t,o;if(u.model._unwatch(u.key,d),u.twoWay)for(n=0,t=u.elements.length;n<t;++n)r(u.elements[n],u.event,a);for(o in m)if(m.hasOwnProperty(o))for(n=0,t=u.elements.length;n<t;++n)r(u.elements[n],o,m[o]);"function"==typeof e&&e.call(u)},Object.defineProperty(u,"visible",{enumerable:!0,configurable:!0,get:function(){var e=!0;return f(u.elements)||f(u.elements[0])||(e="none"!==u.elements[0].style.display),e},set:function(e){for(var n=0,t=u.elements.length;n<t;n++)u.elements[n].style.display=e?u.display||"":"none"}}),Object.defineProperty(u,"disabled",{enumerable:!0,configurable:!0,get:function(){var e=!1;return f(u.elements)||f(u.elements[0])||(e=u.elements[0].disabled),e},set:function(e){for(var n=0,t=u.elements.length;n<t;n++)u.elements[n].disabled=e}}),Object.defineProperty(u,"readOnly",{enumerable:!0,configurable:!0,get:function(){var e=!1;return f(u.elements)||f(u.elements[0])||-1===["INPUT","TEXTAREA"].indexOf(u.elements[0].nodeName)||(e=u.elements[0].readOnly),e},set:function(e){for(var n=0,t=u.elements.length;n<t;n++)-1!==["INPUT","TEXTAREA"].indexOf(u.elements[n].nodeName)&&(u.elements[n].readOnly=e)}}),Object.defineProperty(u,"required",{enumerable:!0,configurable:!0,get:function(){var e=!1;return f(u.elements)||f(u.elements[0])||(e=u.elements[0].required),e},set:function(e){for(var n=0,t=u.elements.length;n<t;n++)u.elements[n].required=e}}),e)e.hasOwnProperty(n)&&"config"!==n&&(u[n]=e[n]);for(n in u.twoWay=void 0===u.twoWay?e.defaults.twoWay:u.twoWay,u.event=u.event||e.defaults.event,u.property=u.property||e.defaults.property,u.elements=e.config.elements||null,u.selector=e.config.selector||null,e.config)e.config.hasOwnProperty(n)&&(u[n]=e.config[n]);if(u.events=u.events||{},f(u.elements))if(f(u.selector))u.elements=null;else if(u.elements="string"==typeof u.selector?u.container.querySelectorAll(u.selector):u.selector,null===u.elements)throw new Error(['"',u.selector.toString(),'" element not found!'])},window.bimo.Binder=function(e){var f,c=this;f=function(e){var n=e;if(null==n)n=document;else if("string"==typeof e&&null===(n=document.querySelector(n)))throw new Error(['"',e,'" container selector not found!']);return n},c.container=f(e.container),c.model=e.model||{},c.binds={},c.run=function(n){function e(e){"function"==typeof e[n]&&e[n].call(e)}var t;for(t in c.binds)if(c.binds.hasOwnProperty(t))if(Array.isArray(c.binds[t]))for(var o=0,r=c.binds[t].length;o<r;o++)e(c.binds[t][o]);else e(c.binds[t])},c.init=function(e,n,t,o){var r;if(e&&(c.container=f(e)),c.model=n,t)for(r in o=o||{twoWay:!0,event:"change",property:"value"},t)if(t.hasOwnProperty(r))if(!0===Array.isArray(t[r])){c.binds[r]=[];for(var i=0,l=t[r].length;i<l;i++){var s=new window.bimo.Bind({container:c.container,model:c.model,key:r,config:t[r][i],defaults:o});c.binds[r].push(s)}}else c.binds[r]=new window.bimo.Bind({container:c.container,model:c.model,key:r,config:t[r],defaults:o})},c.bind=function(e){c.run("bind"),"function"==typeof e&&e.call(c)},c.unbind=function(e){c.run("unbind"),"function"==typeof e&&e.call(c)},e.model&&e.config&&c.init(c.container,c.model,e.config,e.defaults)};